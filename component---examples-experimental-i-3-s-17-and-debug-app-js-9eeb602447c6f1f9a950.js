(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{zCbf:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return G})),n.d(e,"renderToDOM",(function(){return Y}));var r=n("rePB"),a=n("o0o1"),i=n.n(a),o=(n("wcNg"),n("HaE+")),s=n("JX7q"),u=n("dI71"),l=n("q1tI"),c=n.n(l),d=n("i8i4"),f=n("UP1k"),p=n("rta6"),h=n("yYqN"),b=n("Wium"),m=n("BENj"),y=n("NZ3H"),S=n("lese"),v=n("2Daz");function g(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(i.a.mark((function t(e,n){var r,a,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.attributeName,o=n.attributeType,a){t.next=3;break}return t.abrupt("return",{});case 3:return t.abrupt("return",((r={})[a]=o?j(o,e):null,r));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t,e){switch(t){case v.h:return function(t){for(var e,n=new Uint32Array(t,0,4)[0],r=new Uint32Array(t,8,n),a=[],i=8+4*n,o=g(r);!(e=o()).done;){var s=e.value,u=new TextDecoder("utf-8"),l=new Uint8Array(t,i,s);a.push(u.decode(l)),i+=s}return a}(e);case v.f:return x(e);case v.a:return function(t){return new Float64Array(t,8)}(e);default:return x(e)}}function x(t){return new Uint32Array(t,4)}var k=n("24Wh"),P=n("/Xah"),A="undefined"!=typeof __VERSION__?__VERSION__:"latest",C={name:"I3S Attribute",id:"i3s-attribute",module:"i3s",version:A,mimeTypes:["application/binary"],parse:function(t,e){return T.apply(this,arguments)},extensions:["bin"],options:{},binary:!0};function T(){return(T=Object(o.a)(i.a.mark((function t(e,n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=O(e,n),t.abrupt("return",e);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t,e,n){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(i.a.mark((function t(e,n,r){var a,o,s,u,l,c,d,f,p,h;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r={}),a=M(e),o=a.attributeStorageInfo,s=a.attributeUrls,o&&s&&n){t.next=4;break}return t.abrupt("return",null);case 4:for(u=[],l=[],c=0;c<o.length;c++)d=Object(P.c)(s[c],r.token),f=o[c].name,p=U(o[c]),h=Object(k.a)(d,C,{attributeName:f,attributeType:p}),l.push(h);return t.prev=7,t.next=10,Promise.all(l);case 10:u=t.sent,t.next=15;break;case 13:t.prev=13,t.t0=t.catch(7);case 15:if(u.length){t.next=17;break}return t.abrupt("return",null);case 17:return t.abrupt("return",W(u,o,n));case 18:case"end":return t.stop()}}),t,null,[[7,13]])})))).apply(this,arguments)}function M(t){return{attributeStorageInfo:t&&t.tileset&&t.tileset.tileset&&t.tileset.tileset.attributeStorageInfo,attributeUrls:t&&t.header&&t.header.attributeUrls}}function U(t){return t.hasOwnProperty("objectIds")?"Oid32":t.hasOwnProperty("attributeValues")?t.attributeValues.valueType:""}function W(t,e,n){var r=t.find((function(t){return t.OBJECTID}));if(!r)return null;var a=r.OBJECTID.indexOf(n);return a<0?null:function(t,e,n){for(var r={},a=0;a<n.length;a++){var i=n[a].name,o=t[a][i];r[i]=D(o,e)}return r}(t,a,e)}function D(t,e){return t&&t[e]?t[e].toString().replace(/\u0000/g,""):""}var F=n("J4mz"),L=n("rlSs"),z=n("lf6B"),N=n("b1et"),B=n("RUzw"),V=n("IP2g"),J=n("wHSu"),R=n("tuoA");function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Z={longitude:-120,latitude:34,height:600,width:800,pitch:45,maxPitch:60,bearing:0,minZoom:2,maxZoom:30,zoom:14.5},X={wordBreak:"break-word",position:"absolute",padding:12,zIndex:"10000",maxWidth:300,background:"#000",color:"#fff"},G=function(t){function e(e){var n;return(n=t.call(this,e)||this)._tilesetStatsWidget=null,n.state={url:null,token:null,name:L.b,viewState:Z,selectedMapStyle:R.c,selectedFeatureAttributes:null,selectedFeatureIndex:-1,isAttributesLoading:!1},n._onSelectTileset=n._onSelectTileset.bind(Object(s.a)(n)),n.handleClosePanel=n.handleClosePanel.bind(Object(s.a)(n)),n}Object(u.a)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t;this._memWidget=new F.a(p.a.get("Memory Usage"),{framesPerUpdate:1,formatters:{"GPU Memory":"memory","Buffer Memory":"memory","Renderbuffer Memory":"memory","Texture Memory":"memory"},container:this._statsWidgetContainer}),this._tilesetStatsWidget=new F.a(null,{container:this._statsWidgetContainer});var e=Object(B.a)();t=e?{url:e}:L.a[L.b],this._onSelectTileset(t)},n._onSelectTileset=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r,a,o,s,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(B.b)(e.url,e),r=n.tilesetUrl,a=n.token,o=n.name,s=n.metadataUrl,this.setState({tilesetUrl:r,name:o,token:a}),t.next=5,fetch(s).then((function(t){return t.json()}));case 5:u=t.sent,this.setState({metadata:u,selectedFeatureAttributes:null});case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n._updateStatWidgets=function(){this._memWidget.update(),this._tilesetStatsWidget.update()},n._onTilesetLoad=function(t){var e=t.zoom,n=t.cartographicCenter,r=n[0],a=n[1],i=H(H({},this.state.viewState),{},{zoom:e+2.5,longitude:r,latitude:a});this.setState({tileset:t,viewState:H(H({},i),{},{transitionDuration:4e3,transitionInterpolator:new b.a})}),this._tilesetStatsWidget.setStats(t.stats)},n._onViewStateChange=function(t){var e=t.viewState;this.setState({viewState:e})},n._onSelectMapStyle=function(t){var e=t.selectedMapStyle;this.setState({selectedMapStyle:e})},n._renderLayers=function(){var t=this,e=this.state,n=e.tilesetUrl,r=e.token,a=e.selectedFeatureIndex,i={throttleRequests:!0};return r&&(i.token=r),[new y.a({data:n,loader:S.a,onTilesetLoad:this._onTilesetLoad.bind(this),onTileLoad:function(){return t._updateStatWidgets()},onTileUnload:function(){return t._updateStatWidgets()},pickable:!0,loadOptions:i,highlightedObjectIndex:a})]},n.handleClick=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.object&&!(e.index<0)&&e.layer){t.next=3;break}return this.handleClosePanel(),t.abrupt("return");case 3:return n=this.state.token,r={},n&&(r.token=n),this.setState({isAttributesLoading:!0}),t.next=9,I(e.object,e.index,r);case 9:a=t.sent,this.setState({isAttributesLoading:!1}),this.setState({selectedFeatureAttributes:a,selectedFeatureIndex:e.index});case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n._renderStats=function(){var t=this;return c.a.createElement("div",{style:X,ref:function(e){return t._statsWidgetContainer=e}})},n._renderControlPanel=function(){var t=this.state,e=t.name,n=t.tileset,r=t.token,a=t.metadata,i=t.selectedMapStyle;return c.a.createElement(z.a,{tileset:n,name:e,metadata:a,token:r,onExampleChange:this._onSelectTileset,onMapStyleChange:this._onSelectMapStyle.bind(this),selectedMapStyle:i})},n.getTooltip=function(){if(this.state.isAttributesLoading){var t=document.createElement("div");return Object(d.render)(c.a.createElement(V.a,{icon:J.c}),t),{html:t.innerHTML}}return null},n.handleClosePanel=function(){this.setState({selectedFeatureAttributes:null,selectedFeatureIndex:-1})},n.renderAttributesPanel=function(){var t=this.state.selectedFeatureAttributes;return c.a.createElement(N.a,{handleClosePanel:this.handleClosePanel,attributesObject:t})},n.render=function(){var t=this,e=this._renderLayers(),n=this.state,r=n.viewState,a=n.selectedMapStyle,i=n.selectedFeatureAttributes;return c.a.createElement("div",{style:{position:"relative",height:"100%"}},this._renderStats(),i?this.renderAttributesPanel():this._renderControlPanel(),c.a.createElement(h.a,{layers:e,viewState:r,onViewStateChange:this._onViewStateChange.bind(this),controller:{type:m.a,maxPitch:85},onAfterRender:function(){return t._updateStatWidgets()},getTooltip:function(e){return t.getTooltip(e)},onClick:function(e){return t.handleClick(e)}},c.a.createElement(f.a,{mapStyle:a,preventStyleDiffing:!0})))},e}(l.PureComponent);function Y(t){Object(d.render)(c.a.createElement(G,null),t)}}}]);