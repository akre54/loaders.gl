(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{zCbf:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return D})),n.d(t,"renderToDOM",(function(){return L}));var r=n("o0o1"),a=n.n(r),i=(n("wcNg"),n("HaE+")),o=n("JX7q"),l=n("dI71"),s=n("rePB"),c=n("q1tI"),u=n.n(c),d=n("i8i4"),h=n("UP1k"),p=n("rta6"),m=n("yYqN"),f=n("Wium"),b=n("BENj"),g=n("NZ3H"),y=n("lese"),S=n("VBSM"),v=n("J4mz"),w=n("rlSs"),x=n("lf6B"),O={display:"flex",position:"absolute",backgroundColor:"white",flexFlow:"column",top:0,right:0,width:"300px",padding:"12px 18px",maxHeight:"80%",margin:"20px",zIndex:1e3},j={width:"50%",textAlign:"left",borderRight:"3px solid rgba(0,0,0,.05)",padding:".5em .7em"},P={width:"50%",padding:".5em .7em"},C={maxHeight:"50%",overflowY:"auto"},_={display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",alignItems:"center"},k={height:"30px",color:"#6e6e6e",border:"none",cursor:"pointer",outline:"none",fontSize:"19px"},E=function(e){function t(){return e.apply(this,arguments)||this}Object(l.a)(t,e);var n=t.prototype;return n.prepareTable=function(){var e=this.props.attributesObject,t=[];for(var n in e){var r=this.formatValue(e[n]),a=this.createTableColumn(n,r);t.push(a)}return u.a.createElement("div",{style:C},u.a.createElement("table",null,u.a.createElement("tbody",null,t)))},n.createTableColumn=function(e,t){return u.a.createElement("tr",{key:e},u.a.createElement("th",{style:j},e),u.a.createElement("td",{style:P},t))},n.formatValue=function(e){return e.toString().replace(/[{}']+/g,"").trim()||"No Data"},n.render=function(){var e=this.props,t=e.attributesObject,n=e.handleClosePanel,r=e.attributesHeader;return u.a.createElement("div",{style:O},u.a.createElement("div",{style:_},u.a.createElement("h2",null,t[r]),u.a.createElement("button",{style:k,onClick:n},"X")),t&&this.prepareTable())},t}(c.PureComponent);E.defaultProps={attributesObject:{},attributesHeader:"NAME",handleClosePanel:function(){}};var T=n("u/82"),M=n("tuoA");function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F={longitude:-120,latitude:34,height:600,width:800,pitch:45,maxPitch:60,bearing:0,minZoom:2,maxZoom:30,zoom:14.5},U={wordBreak:"break-word",position:"absolute",padding:12,zIndex:"10000",maxWidth:300,background:"#000",color:"#fff"};function I(e,t){var n=new URL(e),r=t&&t.token,a=e.includes("layers/0")?e:e.replace(/\/?$/,"/").concat("layers/0"),i=a.lastIndexOf("/layers/0"),o=a.substring(0,i);return n.search&&(r=n.searchParams.get("token"),o=""+o+n.search),A(A({},t),{},{tilesetUrl:a,token:r,metadataUrl:o})}var D=function(e){function t(t){var n;return(n=e.call(this,t)||this)._tilesetStatsWidget=null,n.state={url:null,token:null,name:w.b,viewState:F,selectedMapStyle:M.c,selectedFeatureAttributes:null,selectedFeatureIndex:-1},n._onSelectTileset=n._onSelectTileset.bind(Object(o.a)(n)),n.handleClosePanel=n.handleClosePanel.bind(Object(o.a)(n)),n}Object(l.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e;this._memWidget=new v.a(p.a.get("Memory Usage"),{framesPerUpdate:1,formatters:{"GPU Memory":"memory","Buffer Memory":"memory","Renderbuffer Memory":"memory","Texture Memory":"memory"},container:this._statsWidgetContainer}),this._tilesetStatsWidget=new v.a(null,{container:this._statsWidgetContainer});var t=new URL(window.location.href).searchParams.get("url");e=t?{url:t}:w.a[w.b],this._onSelectTileset(e)},n._onSelectTileset=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,o,l,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=I(t.url,t),r=n.tilesetUrl,i=n.token,o=n.name,l=n.metadataUrl,this.setState({tilesetUrl:r,name:o,token:i}),e.next=5,fetch(l).then((function(e){return e.json()}));case 5:s=e.sent,this.setState({metadata:s,selectedFeatureAttributes:null});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._updateStatWidgets=function(){this._memWidget.update(),this._tilesetStatsWidget.update()},n._onTilesetLoad=function(e){var t=e.zoom,n=e.cartographicCenter,r=n[0],a=n[1],i=A(A({},this.state.viewState),{},{zoom:t+2.5,longitude:r,latitude:a});this.setState({tileset:e,viewState:A(A({},i),{},{transitionDuration:4e3,transitionInterpolator:new f.a})}),this._tilesetStatsWidget.setStats(e.stats)},n._onViewStateChange=function(e){var t=e.viewState;this.setState({viewState:t})},n._onSelectMapStyle=function(e){var t=e.selectedMapStyle;this.setState({selectedMapStyle:t})},n._renderLayers=function(){var e=this,t=this.state,n=t.tilesetUrl,r=t.token,a=t.selectedFeatureIndex,i={throttleRequests:!0,loadFeatureAttributes:!0};return r&&(i.token=r),[new g.a({data:n,loader:y.a,onTilesetLoad:this._onTilesetLoad.bind(this),onTileLoad:function(){return e._updateStatWidgets()},onTileUnload:function(){return e._updateStatWidgets()},pickable:!0,loadOptions:i,highlightedObjectIndex:a})]},n.handleClick=function(e){if(!e.object||e.index<0||!e.layer)this.handleClosePanel();else{var t=Object(S.b)(e.object,e.index);this.setState({selectedFeatureAttributes:t,selectedFeatureIndex:e.index})}},n._renderStats=function(){var e=this;return u.a.createElement("div",{style:U,ref:function(t){return e._statsWidgetContainer=t}})},n._renderControlPanel=function(){var e=this.state,t=e.name,n=e.tileset,r=e.token,a=e.metadata,i=e.selectedMapStyle;return u.a.createElement(x.a,{tileset:n,name:t,metadata:a,token:r,onExampleChange:this._onSelectTileset,onMapStyleChange:this._onSelectMapStyle.bind(this),selectedMapStyle:i})},n.getTooltip=function(e){if(!e.object||e.index<0||!e.layer)return null;var t=Object(S.b)(e.object,e.index),n=document.createElement("div");return Object(d.render)(u.a.createElement(T.a,{data:t}),n),{html:n.innerHTML}},n.handleClosePanel=function(){this.setState({selectedFeatureAttributes:null,selectedFeatureIndex:-1})},n.renderAttributesPanel=function(){var e=this.state.selectedFeatureAttributes;return u.a.createElement(E,{handleClosePanel:this.handleClosePanel,attributesObject:e})},n.render=function(){var e=this,t=this._renderLayers(),n=this.state,r=n.viewState,a=n.selectedMapStyle,i=n.selectedFeatureAttributes;return u.a.createElement("div",{style:{position:"relative",height:"100%"}},this._renderStats(),i?this.renderAttributesPanel():this._renderControlPanel(),u.a.createElement(m.a,{layers:t,viewState:r,onViewStateChange:this._onViewStateChange.bind(this),controller:{type:b.a,maxPitch:85},onAfterRender:function(){return e._updateStatWidgets()},getTooltip:function(t){return e.getTooltip(t)},onClick:function(t){return e.handleClick(t)}},u.a.createElement(h.a,{mapStyle:a,preventStyleDiffing:!0})))},t}(c.PureComponent);function L(e){Object(d.render)(u.a.createElement(D,null),e)}}}]);