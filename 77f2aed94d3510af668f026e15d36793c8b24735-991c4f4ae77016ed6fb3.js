(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{BZIa:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return u}));var n=i("a3TU"),r=Math.PI/2;function a(t,e){var i=e.viewport,n=i.metersPerPixel,a=t.header.mbs[1],s=t.header.mbs[0],c=t.header.mbs[2],h=t.header.mbs[3],l=i.height,f=i.width,d=i.latitude,m=i.longitude,p=[m,d],v=[s,a,c],y=[m,a],g=[s,d],b=Math.sqrt(l*l+f*f)*n[0],_=.5*l+h/6378137,O=.5*f+h/6378137;if(o(p,v)>b+h/6378137)return"OUT";if(o(p,y)>_)return"OUT";if(o(p,g)>O)return"OUT";if(0===t.lodMetricValue)return"DIG";var w=u(t,e);return(w*=r)<.5?"OUT":!t.header.children||w<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function s(t){var e=t[0],i=t[1],r=t[2],a=Object(n.j)(e),s=Object(n.j)(i),o=1+r/6378137,u=o*Math.cos(s);return[e=u*Math.cos(a),i=u*Math.sin(a),r=o*Math.sin(s)]}function o(t,e){var i=t[0],n=t[1],r=t[2],a=void 0===r?0:r,o=e[0],u=e[1],c=e[2],h=s([o,u,void 0===c?0:c]),l=s([i,n,a]),f=l[0]-h[0],d=l[1]-h[1],m=l[2]-h[2];return f*f+d*d+m*m}function u(t,e){var i=e.viewport,n=t.header.mbs[1],r=[t.header.mbs[0],n,t.header.mbs[2]],a=t.header.mbs[3]/6378137,s=o(i.unprojectPosition(i.cameraPosition),r)-a*a;if(s<=0)return 170141175e30;var u=function(t,e){var i=e.viewport,n=i.width,r=i.height,a=i.pixelProjectionMatrix,s=Math.tan(Math.atan(Math.sqrt(1/(a[0]*a[0])+1/(a[5]*a[5]))));return Math.sqrt(r*r+n*n)/s}(0,e);return u*=a/Math.sqrt(s)/i.scale}},"FJ6+":function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"e",(function(){return r})),i.d(e,"f",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return u}));var n={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},r={ADD:1,REPLACE:2},a={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},s={I3S:"I3S",TILES3D:"TILES3D"},o={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},u={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0}},Fqdk:function(t,e,i){"use strict";i.d(e,"a",(function(){return K}));var n=i("o0o1"),r=i.n(n),a=(i("wcNg"),i("HaE+")),s=i("rePB"),o=i("vuIU"),u=i("Nw31"),c=i("zXfU"),h=i("Ns70"),l=i("1OyB"),f=i("P8Q2"),d=function(){function t(e,i){Object(l.a)(this,t),this.name=e,this.type=i,this.sampleSize=1,this.reset()}return Object(o.a)(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(f.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(f.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),m=function(){function t(e){var i=e.id,n=e.stats;Object(l.a)(this,t),this.id=i,this.stats={},this._initializeStats(n),Object.seal(this)}return Object(o.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,i=t.type;return this.stats[e]||(this.stats[e]=t instanceof d?t:new d(e,i)),this.stats[e]}}]),t}(),p=i("Qk7e"),v=i("VnMh"),y=i("wBSN"),g=function(t,e,i){this.item=t,this.previous=e,this.next=i},b=function(){function t(){this.head=null,this.tail=null,this._length=0}var e=t.prototype;return e.add=function(t){var e=new g(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e},e.remove=function(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)},e.splice=function(t,e){t!==e&&(this.remove(e),this._insert(t,e))},e._insert=function(t,e){var i=t.next;t.next=e,this.tail===t?this.tail=e:i.previous=e,e.next=i,e.previous=t,++this._length},Object(o.a)(t,[{key:"length",get:function(){return this._length}}]),t}();function _(t){return null!=t}var O=function(){function t(){this._list=new b,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}var e=t.prototype;return e.reset=function(){this._list.splice(this._list.tail,this._sentinel)},e.touch=function(t){var e=t._cacheNode;_(e)&&this._list.splice(this._sentinel,e)},e.add=function(t,e,i){_(e._cacheNode)||(e._cacheNode=this._list.add(e),i&&i(t,e))},e.unloadTile=function(t,e,i){var n=e._cacheNode;_(n)&&(this._list.remove(n),e._cacheNode=void 0,i&&i(t,e))},e.unloadTiles=function(t,e){var i=this._trimTiles;this._trimTiles=!1;for(var n=this._list,r=1024*t.maximumMemoryUsage*1024,a=this._sentinel,s=n.head;s!==a&&(t.gpuMemoryUsageInBytes>r||i);){var o=s.item;s=s.next,this.unloadTile(t,o,e)}},e.trim=function(){this._trimTiles=!0},t}();var w=i("rOwd"),T=new c.a,S=new c.a,j=new w.b([new w.d,new w.d,new w.d,new w.d,new w.d,new w.d]);function E(t,e){var i=t.cameraDirection,n=t.cameraUp,r=t.height,a=t.distanceScales.metersPerUnit,s=[t.longitude,t.latitude,0],o=h.a.WGS84.cartographicToCartesian(s,new c.a),u=h.a.WGS84.eastNorthUpToFixedFrame(o),l=t.unprojectPosition(t.cameraPosition),f=h.a.WGS84.cartographicToCartesian(l,new c.a),d=new c.a(u.transformAsVector(new c.a(i).scale(a))).normalize(),m=new c.a(u.transformAsVector(new c.a(n).scale(a))).normalize();return function(t,e){var i=t.getFrustumPlanes(),n=0;for(var r in i){var a=i[r],s=a.normal.dot(t.center);S.copy(a.normal).scale(a.distance-s).add(t.center);var o=t.unprojectPosition(S),u=h.a.WGS84.cartographicToCartesian(o,new c.a);j.planes[n++].fromPointNormal(u,T.copy(e).subtract(u))}}(t,o),{camera:{position:f,direction:d,up:m},viewport:t,height:r,cullingVolume:j,frameNumber:e,sseDenominator:1.15}}var M=new c.a;function x(t){var e=t.halfAxes,i=t.radius,n=t.width,r=t.height;if(e){var a=function(t){t.getColumn(0,M);var e=t.getColumn(1),i=t.getColumn(2);return M.add(e).add(i).len()}(e);return Math.log2(6356752.314245179/a)}return i?Math.log2(6356752.314245179/i):r&&n?(Math.log2(6378137/n)+Math.log2(6378137/r))/2:1}var k=i("fa8B"),P=i("dI71"),C=i("FJ6+"),I=i("vrw9"),R=function(t){function e(){return t.apply(this,arguments)||this}Object(P.a)(e,t);var i=e.prototype;return i.compareDistanceToCamera=function(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera},i.updateTileVisibility=function(e,i){if(t.prototype.updateTileVisibility.call(this,e,i),e.isVisibleAndInRequestVolume){var n=e.children.length>0;if(e.hasTilesetContent&&n){var r=e.children[0];return this.updateTileVisibility(r,i),void(e._visible=r._visible)}if(this.meetsScreenSpaceErrorEarly(e,i))e._visible=!1;else{var a=e.refine===C.e.REPLACE,s=e._optimChildrenWithinParent===C.b.USE_OPTIMIZATION;a&&s&&n&&!this.anyChildrenVisible(e,i)&&(e._visible=!1)}}},i.meetsScreenSpaceErrorEarly=function(t,e){var i=t.parent;return!(!i||i.hasTilesetContent||i.refine!==C.e.ADD)&&!this.shouldRefine(t,e,!0)},e}(I.a),N=i("xszv"),D=i("BZIa"),A="REQUESTED",q="COMPLETED",z="ERROR",V=function(){function t(){this._statusMap={}}var e=t.prototype;return e.add=function(t,e,i,n){var r=this;this._statusMap[e]||(this._statusMap[e]={request:t,callback:i,key:e,frameState:n,status:A},t().then((function(t){r._statusMap[e].status=q,r._statusMap[e].callback(t,n)})).catch((function(t){r._statusMap[e].status=z,i(t)})))},e.update=function(t,e){this._statusMap[t]&&(this._statusMap[t].frameState=e)},e.find=function(t){return this._statusMap[t]},t}();function U(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function L(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(Object(i),!0).forEach((function(e){Object(s.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function F(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var G=function(t){function e(e){var i;return(i=t.call(this,e)||this)._tileManager=new V,i}Object(P.a)(e,t);var i=e.prototype;return i.shouldRefine=function(t,e){return t._lodJudge=Object(D.b)(t,e),"DIG"===t._lodJudge},i.updateChildTiles=function(t,e){for(var i,n=this,r=t.header.children||[],a=t.children,s=t.tileset,o=function(){var r=i.value,o=r.id+"-"+e.viewport.id,u=a&&a.find((function(t){return t.id===o}));if(u)u&&n.updateTile(u,e);else{var c=function(){return n._loadTile(r.id,s)};n._tileManager.find(o)?n._tileManager.update(o,e):(s.tileset.nodePages&&(c=function(){return s.tileset.nodePagesTile.formTileFromNodePages(r.id)}),n._tileManager.add(c,o,(function(e){return n._onTileLoad(e,t,o)}),e))}},u=F(r);!(i=u()).done;)o();return!1},i._loadTile=function(){var t=Object(a.a)(r.a.mark((function t(e,i){var n,a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.loader,a=i.getTileUrl(i.url+"/nodes/"+e),s=L(L({},i.loadOptions),{},{i3s:L(L({},i.loadOptions.i3s),{},{isTileHeader:!0,loadContent:!1})}),t.next=5,Object(N.a)(a,n,s);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}(),i._onTileLoad=function(t,e,i){var n=new k.a(e.tileset,t,e,i);e.children.push(n);var r=this._tileManager.find(n.id).frameState;this.updateTile(n,r),this._frameNumber===r.frameNumber&&this.executeTraversal(n,r)},e}(I.a);function W(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return X(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return X(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function H(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Q(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?H(Object(i),!0).forEach((function(e){Object(s.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Z={description:"",ellipsoid:h.a.WGS84,modelMatrix:new u.a,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){},onTraversalComplete:function(t){return t},contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},K=function(){function t(t,e){Object(p.a)(t),this.options=Q(Q({},Z),e),this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||v.a.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new O,this._requestScheduler=new y.a({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new m({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this._initializeTileSet(t)}var e=t.prototype;return e.destroy=function(){this._destroy()},e.isLoaded=function(){return 0===this._pendingCount&&0!==this._frameNumber},e.setProps=function(t){this.options=Q(Q({},this.options),t)},e.setOptions=function(t){this.options=Q(Q({},this.options),t)},e.getTileUrl=function(t){return t.startsWith("data:")?t:""+t+this.queryParams},e.hasExtension=function(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)},e.update=function(t){if((!("loadTiles"in this.options)||this.options.loadTiles)&&!(this.traverseCounter>0)){!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t instanceof Array||(t=[t]),this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;for(var e,i=[],n=W(t);!(e=n()).done;){var r=e.value.id;this._needTraverse(r)?i.push(r):this.traverseCounter--}for(var a,s=W(t);!(a=s()).done;){var o=a.value,u=o.id;if(this.roots[u]||(this.roots[u]=this._initializeTileHeaders(this.tileset,null)),i.includes(u)){var c=E(o,this._frameNumber);this._traverser.traverse(this.roots[u],c,this.options)}}}},e._needTraverse=function(t){var e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t},e._onTraversalEnd=function(t){var e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});var i=this.frameStateData[e],n=Object.values(this._traverser.selectedTiles);i.selectedTiles=n,i._requestedTiles=Object.values(this._traverser.requestedTiles),i._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()},e._updateTiles=function(){for(var t in this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[],this.frameStateData){var e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(var i,n=W(this.selectedTiles);!(i=n()).done;){var r=i.value;this._tiles[r.id]=r}this._loadTiles(),this._unloadTiles(),this._updateStats()},e._tilesChanged=function(t,e){if(t.length!==e.length)return!0;var i=new Set(t.map((function(t){return t.id}))),n=new Set(e.map((function(t){return t.id}))),r=t.filter((function(t){return!n.has(t.id)})).length>0;return r=r||e.filter((function(t){return!i.has(t.id)})).length>0},e._loadTiles=function(){for(var t,e=W(this._requestedTiles);!(t=e()).done;){var i=t.value;i.contentUnloaded&&this._loadTile(i)}},e._unloadTiles=function(){this._cache.unloadTiles(this,(function(t,e){return t._unloadTile(e)}))},e._updateStats=function(){for(var t,e=0,i=0,n=W(this.selectedTiles);!(t=n()).done;){var r=t.value;r.contentAvailable&&r.content&&(e++,r.content.pointCount&&(i+=r.content.pointCount))}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=e,this.stats.get("Points").count=i},e._initializeTileSet=function(t){this.root=this._initializeTileHeaders(t,null),this.type===C.c.TILES3D&&this._initializeCesiumTileset(t),this.type===C.c.I3S&&this._initializeI3STileset(),this._calculateViewProps()},e._calculateViewProps=function(){var t=this.root;Object(p.a)(t);var e=t.boundingVolume.center;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new c.a,void(this.zoom=1);this.cartographicCenter=h.a.WGS84.cartesianToCartographic(e,new c.a),this.cartesianCenter=e,this.zoom=x(t.boundingVolume)},e._initializeStats=function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")},e._initializeTileHeaders=function(t,e){var i=new k.a(this,t.root,e);if(e&&(e.children.push(i),i.depth=e.depth+1),this.type===C.c.TILES3D){var n=[];for(n.push(i);n.length>0;){var r=n.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();for(var a,s=W(r.header.children||[]);!(a=s()).done;){var o=a.value,u=new k.a(this,o,r);r.children.push(u),u.depth=r.depth+1,n.push(u)}}}return i},e._initializeTraverser=function(){var t;switch(this.type){case C.c.TILES3D:t=R;break;case C.c.I3S:t=G;break;default:t=I.a}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})},e._destroyTileHeaders=function(t){this._destroySubtree(t)},e._loadTile=function(){var t=Object(a.a)(r.a.mark((function t(e){var i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._onStartTileLoading(),t.next=4,e.loadContent();case 4:i=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this._onTileLoadError(e,t.t0);case 10:return t.prev=10,this._onEndTileLoading(),this._onTileLoad(e,i),t.finish(10);case 14:case"end":return t.stop()}}),t,this,[[0,7,10,14]])})));return function(e){return t.apply(this,arguments)}}(),e._onTileLoadError=function(t,e){this.stats.get("Failed Tile Loads").incrementCount();var i=e.message||e.toString(),n=t.url;console.error("A 3D tile failed to load: "+t.url+" "+i),this.options.onTileError(t,i,n)},e._onTileLoad=function(t,e){e&&(t&&t.content&&function(t,e){Object(p.a)(t),Object(p.a)(e);var i=e.rtcCenter,n=e.gltfUpAxis,r=t.computedTransform,a=t.boundingVolume.center,s=new u.a(r);switch(i&&s.translate(i),n){case"Z":break;case"Y":var o=(new u.a).rotateX(Math.PI/2);s=s.multiplyRight(o);break;case"X":var l=(new u.a).rotateY(-Math.PI/2);s=s.multiplyRight(l)}e.isQuantized&&s.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);var f=new c.a(a);e.cartesianModelMatrix=s,e.cartesianOrigin=f;var d=h.a.WGS84.cartesianToCartographic(f,new c.a),m=h.a.WGS84.eastNorthUpToFixedFrame(f).invert();e.cartographicModelMatrix=m.multiplyRight(s),e.cartographicOrigin=d,e.modelMatrix=e.cartographicModelMatrix}(t,t.content),this._addTileToCache(t),this.options.onTileLoad(t))},e._onStartTileLoading=function(){this._pendingCount++,this.stats.get("Tiles Loading").incrementCount()},e._onEndTileLoading=function(){this._pendingCount--,this.stats.get("Tiles Loading").decrementCount()},e._addTileToCache=function(t){this._cache.add(this,t,(function(e){return e._updateCacheStats(t)}))},e._updateCacheStats=function(t){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes},e._unloadTile=function(t){this.gpuMemoryUsageInBytes-=t.content&&t.content.byteLength||0,this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()},e._destroy=function(){var t=[];for(this.root&&t.push(this.root);t.length>0;){for(var e,i=t.pop(),n=W(i.children);!(e=n()).done;){var r=e.value;t.push(r)}this._destroyTile(i)}this.root=null},e._destroySubtree=function(t){var e=t,i=[];for(i.push(e);i.length>0;){for(var n,r=W((t=i.pop()).children);!(n=r()).done;){var a=n.value;i.push(a)}t!==e&&this._destroyTile(t)}e.children=[]},e._destroyTile=function(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()},e._initializeCesiumTileset=function(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras},e._initializeI3STileset=function(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)},Object(o.a)(t,[{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"frameNumber",get:function(){return this._frameNumber}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=function(t){for(var e=[],i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];e.push(r+"="+t[r])}switch(e.length){case 0:return"";case 1:return"?"+e[0];default:return"?"+e.join("&")}}(this._queryParams)),this._queryParamsString}}]),t}()},GA6j:function(t,e,i){"use strict";i.d(e,"a",(function(){return b}));var n=i("1OyB"),r=i("vuIU"),a=i("Ji7U"),s=i("md7G"),o=i("foSv"),u=i("fxzv"),c=i("+H0l"),h=i("sSh/"),l=i("HwUG"),f=i("ZxFD"),d=i("n+fv");function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Object(o.a)(t);if(e){var r=Object(o.a)(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Object(s.a)(this,i)}}var p=Object.freeze([1,0,0,0,1,0,0,0,1]),v=Object.freeze([0,0,0,0,0,0,0,0,0]),y=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),g={},b=function(t){Object(a.a)(i,t);var e=m(i);function i(t){var r;return Object(n.a)(this,i),r=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?r.copy(t):r.identity(),r}return Object(r.a)(i,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return y}}],[{key:"IDENTITY",get:function(){return g.IDENTITY=g.IDENTITY||Object.freeze(new i(p)),g.IDENTITY}},{key:"ZERO",get:function(){return g.ZERO=g.ZERO||Object.freeze(new i(v)),g.ZERO}}]),Object(r.a)(i,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,i,n,r,a,s,o,u){return this[0]=t,this[1]=e,this[2]=i,this[3]=n,this[4]=r,this[5]=a,this[6]=s,this[7]=o,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,i,n,r,a,s,o,u){return this[0]=t,this[1]=n,this[2]=s,this[3]=e,this[4]=r,this[5]=o,this[6]=i,this[7]=a,this[8]=u,this.check()}},{key:"determinant",value:function(){return l.b(this)}},{key:"identity",value:function(){return this.copy(p)}},{key:"fromQuaternion",value:function(t){return l.c(this,t),this.check()}},{key:"transpose",value:function(){return l.i(this,this),this.check()}},{key:"invert",value:function(){return l.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return l.e(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return l.e(this,this,t),this.check()}},{key:"rotate",value:function(t){return l.f(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?l.g(this,this,t):l.g(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return l.h(this,this,t),this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=f.i(e||[-0,-0],t,this);break;case 3:e=d.n(e||[-0,-0,-0],t,this);break;case 4:e=Object(h.d)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"transformVector",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return Object(c.c)("Matrix3.transformVector"),this.transform(t,e)}}]),i}(u.a)},Ns70:function(t,e,i){"use strict";i.d(e,"a",(function(){return A}));var n=i("ODXe"),r=i("1OyB"),a=i("vuIU"),s=i("zXfU"),o=i("tS8E"),u=i("gOKY"),c=i("Nw31"),h=i("a3TU"),l=i("n+fv"),f=(Math.max(6378137,6378137,6356752.314245179),function(t){return t}),d=new s.a;function m(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(h.f)(t)?(e[0]=i(t[0]),e[1]=i(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=i(t.longitude),e[1]=i(t.latitude),e[2]=t.height):(e[0]=i(t.x),e[1]=i(t.y),e[2]=t.z),e}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return m(t,e,h.b._cartographicRadians?f:h.j)}function v(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(h.f)(e)?(e[0]=i(t[0]),e[1]=i(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=i(t[0]),e.latitude=i(t[1]),e.height=t[2]):(e.x=i(t[0]),e.y=i(t[1]),e.z=t[2]),e}function y(t,e){return v(t,e,h.b._cartographicRadians?f:h.i)}var g=new s.a,b=new s.a,_=new s.a;var O=new s.a,w={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},T={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},S={east:new s.a,north:new s.a,up:new s.a,west:new s.a,south:new s.a,down:new s.a},j=new s.a,E=new s.a,M=new s.a;function x(t,e,i,n,r,a){var s,u,c,l=w[e]&&w[e][i];Object(o.a)(l&&(!n||n===l));var f=O.copy(r);if(Object(h.d)(f.x,0,1e-14)&&Object(h.d)(f.y,0,1e-14)){var d=Math.sign(f.z);s=j.fromArray(T[e]),"east"!==e&&"west"!==e&&s.scale(d),u=E.fromArray(T[i]),"east"!==i&&"west"!==i&&u.scale(d),c=M.fromArray(T[n]),"east"!==n&&"west"!==n&&c.scale(d)}else{var m=S.up,p=S.east,v=S.north;p.set(-f.y,f.x,0).normalize(),t.geodeticSurfaceNormal(f,m),v.copy(m).cross(p);var y=S.west,g=S.south;S.down.copy(m).scale(-1),y.copy(p).scale(-1),g.copy(v).scale(-1),s=S[e],u=S[i],c=S[n]}return a[0]=s.x,a[1]=s.y,a[2]=s.z,a[3]=0,a[4]=u.x,a[5]=u.y,a[6]=u.z,a[7]=0,a[8]=c.x,a[9]=c.y,a[10]=c.z,a[11]=0,a[12]=f.x,a[13]=f.y,a[14]=f.z,a[15]=1,a}var k,P=new s.a,C=new s.a,I=new s.a,R=new s.a,N=new s.a,D=new s.a,A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(r.a)(this,t),Object(o.a)(e>=0),Object(o.a)(i>=0),Object(o.a)(n>=0),this.radii=new s.a(e,i,n),this.radiiSquared=new s.a(e*e,i*i,n*n),this.radiiToTheFourth=new s.a(e*e*e*e,i*i*i*i,n*n*n*n),this.oneOverRadii=new s.a(0===e?0:1/e,0===i?0:1/i,0===n?0:1/n),this.oneOverRadiiSquared=new s.a(0===e?0:1/(e*e),0===i?0:1/(i*i),0===n?0:1/(n*n)),this.minimumRadius=Math.min(e,i,n),this.maximumRadius=Math.max(e,i,n),this.centerToleranceSquared=u.a.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(a.a)(t,null,[{key:"WGS84",get:function(){return k=k||new t(6378137,6378137,6356752.314245179)}}]),Object(a.a)(t,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=C,r=I,a=Object(n.a)(t,3),s=a[2];this.geodeticSurfaceNormalCartographic(t,i),r.copy(this.radiiSquared).scale(i);var o=Math.sqrt(i.dot(r));return r.scale(1/o),i.scale(s),r.add(i),r.to(e)}},{key:"cartesianToCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];D.from(t);var i=this.scaleToGeodeticSurface(D,R);if(i){var n=this.geodeticSurfaceNormal(i,C),r=N;r.copy(D).subtract(i);var a=Math.atan2(n.y,n.x),s=Math.asin(n.z),o=Math.sign(l.d(r,D))*l.g(r);return y([a,s,o],e)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c.a;return x(this,"east","north","up",t,e)}},{key:"localFrameToFixedFrame",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new c.a;return x(this,t,e,i,n,r)}},{key:"geocentricSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return P.from(t).normalize().to(e)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=p(t),n=i[0],r=i[1],a=Math.cos(r);return P.set(a*Math.cos(n),a*Math.sin(n),Math.sin(r)).normalize(),P.to(e)}},{key:"geodeticSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return P.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}},{key:"scaleToGeodeticSurface",value:function(t,e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new s.a,n=e.oneOverRadii,r=e.oneOverRadiiSquared,a=e.centerToleranceSquared;g.from(t);var o=t.x,c=t.y,h=t.z,l=n.x,f=n.y,d=n.z,m=o*o*l*l,p=c*c*f*f,v=h*h*d*d,y=m+p+v,O=Math.sqrt(1/y);if(Number.isFinite(O)){var w=b;if(w.copy(t).scale(O),y<a)return w.to(i);var T=r.x,S=r.y,j=r.z,E=_;E.set(w.x*T*2,w.y*S*2,w.z*j*2);var M,x,k,P,C=(1-O)*t.len()/(.5*E.len()),I=0;do{var R=(M=1/(1+(C-=I)*T))*M,N=(x=1/(1+C*S))*x,D=(k=1/(1+C*j))*k,A=R*M,q=N*x,z=D*k,V=m*A*T+p*q*S+v*z*j,U=-2*V;I=(P=m*R+p*N+v*D-1)/U}while(Math.abs(P)>u.a.EPSILON12);return g.scale([M,x,k]).to(i)}}(t,this,e)}},{key:"scaleToGeocentricSurface",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];R.from(t);var i=R.x,n=R.y,r=R.z,a=this.oneOverRadiiSquared,s=1/Math.sqrt(i*i*a.x+n*n*a.y+r*r*a.z);return R.multiplyScalar(s).to(e)}},{key:"transformPositionToScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return R.from(t).scale(this.oneOverRadii).to(e)}},{key:"transformPositionFromScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return R.from(t).scale(this.radii).to(e)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(o.a)(Object(h.d)(this.radii.x,this.radii.y,u.a.EPSILON15)),Object(o.a)(this.radii.z>0),R.from(t);var n=R.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(n)>=this.radii.z-e))return R.set(0,0,n).to(i)}}]),t}()},P8Q2:function(t,e,i){"use strict";(function(t){function n(){var e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==t&&t.hrtime){var i=t.hrtime();e=1e3*i[0]+i[1]/1e6}else e=Date.now();return e}i.d(e,"a",(function(){return n}))}).call(this,i("8oxB"))},VnMh:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n={};function r(t){var e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}function a(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n="/";return(e=e.map((function(t,i){return i&&(t=t.replace(new RegExp("^"+n),"")),i!==e.length-1&&(t=t.replace(new RegExp(n+"$"),"")),t}))).join(n)}i.r(n),i.d(n,"dirname",(function(){return r})),i.d(n,"join",(function(){return a}))},XPjF:function(t,e,i){"use strict";(function(t){function n(){var e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==t&&t.hrtime){var i=t.hrtime();e=1e3*i[0]+i[1]/1e6}else e=Date.now();return e}i.d(e,"a",(function(){return n}))}).call(this,i("8oxB"))},fa8B:function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var n=i("o0o1"),r=i.n(n),a=i("rePB"),s=(i("wcNg"),i("HaE+")),o=i("vuIU"),u=i("zXfU"),c=i("Nw31"),h=i("rOwd"),l=i("xszv"),f=i("FJ6+"),d=i("KQm4"),m=i("a3TU"),p=i("Xjzu"),v=i("GA6j"),y=i("Ns70"),g=i("Qk7e");function b(t){return null!=t}var _=new u.a,O=new u.a,w=new u.a;new c.a;function T(t,e,i){if(Object(g.a)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,i){var n=new u.a(t[0],t[1],t[2]);e.transform(n,n);var r=[];if(10===t.length){var a=t.slice(3,6),s=new p.a;s.fromArray(t,6);var o=new u.a([1,0,0]),c=new u.a([0,1,0]),l=new u.a([0,0,1]);o.transformByQuaternion(s),o.scale(a[0]),c.transformByQuaternion(s),c.scale(a[1]),l.transformByQuaternion(s),l.scale(a[2]),r=[].concat(Object(d.a)(o.toArray()),Object(d.a)(c.toArray()),Object(d.a)(l.toArray()))}else r=[].concat(Object(d.a)(t.slice(3,6)),Object(d.a)(t.slice(6,9)),Object(d.a)(t.slice(9,12)));var f=e.transformAsVector(r.slice(0,3)),m=e.transformAsVector(r.slice(3,6)),y=e.transformAsVector(r.slice(6,9)),g=new v.a([f[0],f[1],f[2],m[0],m[1],m[2],y[0],y[1],y[2]]);if(b(i))return i.center=n,i.halfAxes=g,i;return new h.c(n,g)}(t.box,e,i);if(t.region){var n=t.region,r=n[0],a=n[1],s=n[2],o=n[3],l=n[4],f=n[5],_=y.a.WGS84.cartographicToCartesian([Object(m.c)(r),Object(m.c)(o),l],O),T=y.a.WGS84.cartographicToCartesian([Object(m.c)(s),Object(m.c)(a),f],w),j=(new u.a).addVectors(_,T).multiplyScalar(.5),E=(new u.a).subVectors(_,T).len()/2;return S([j[0],j[1],j[2],E],new c.a)}if(t.sphere)return S(t.sphere,e,i);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function S(t,e,i){var n=new u.a(t[0],t[1],t[2]);e.transform(n,n);var r=e.getScale(_),a=Math.max(Math.max(r[0],r[1]),r[2]),s=t[3]*a;return b(i)?(i.center=n,i.radius=s,i):new h.a(n,s)}new u.a,new u.a,new c.a,new u.a,new u.a,new u.a;function j(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){var i=t.dynamicScreenSpaceErrorComputedDensity,n=t.dynamicScreenSpaceErrorFactor;return function(t,e){var i=t*e;return 1-Math.exp(-i*i)}(e,i)*n}return 0}var E=i("BZIa");var M=i("vrw9");function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){Object(a.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var P=new u.a;var C=function(){function t(t,e,i,n){void 0===n&&(n=""),this.header=e,this.tileset=t,this.id=n||e.id,this.url=e.url,this.parent=i,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=f.d.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new M.a({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new c.a,this.transform=new c.a,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}var e=t.prototype;return e.destroy=function(){this.header=null},e.isDestroyed=function(){return null===this.header},e.getScreenSpaceError=function(t,e){switch(this.tileset.type){case f.c.I3S:return Object(E.a)(this,t);case f.c.TILES3D:return function(t,e,i){var n=t.tileset,r=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,a=i?r:t.lodMetricValue;if(0===a)return 0;var s=Math.max(t._distanceToCamera,1e-7),o=e.height,u=e.sseDenominator,c=a*o*(n.options.viewDistanceScale||1)/(s*u);return c-=j(n,s)}(this,t,e);default:throw new Error("Unsupported tileset type")}},e._getPriority=function(){var t=this.tileset._traverser,e=t.options.skipLevelOfDetail,i=this.refine===f.e.ADD||e;if(i&&!this.isVisible&&void 0!==this._visible)return-1;if(this.contentState===f.d.UNLOADED)return-1;var n=this.parent,r=n&&(!i||0===this._screenSpaceError||n.hasTilesetContent)?n._screenSpaceError:this._screenSpaceError,a=t.root?t.root._screenSpaceError:0;return Math.max(a-r,0)},e.loadContent=function(){var t=Object(s.a)(r.a.mark((function t(){var e,i,n,a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasEmptyContent){t.next=2;break}return t.abrupt("return",!1);case 2:if(!this.content){t.next=4;break}return t.abrupt("return",!0);case 4:return this.contentExpired&&(this._expireDate=null),this.contentState=f.d.LOADING,t.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));case 9:if(e=t.sent){t.next=13;break}return this.contentState=f.d.UNLOADED,t.abrupt("return",!1);case 13:return t.prev=13,n=this.tileset.getTileUrl(this.contentUrl),a=this.tileset.loader,s=k(k({},this.tileset.loadOptions),{},((i={})[a.id]=k(k({},this.tileset.loadOptions[a.id]),{},{isTileset:"json"===this.type},this._getLoaderSpecificOptions(a.id)),i)),t.next=19,Object(l.a)(n,a,s);case 19:if(this.content=t.sent,!this.tileset.options.contentLoader){t.next=23;break}return t.next=23,this.tileset.options.contentLoader(this);case 23:return this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=f.d.READY,this._onContentLoaded(),t.abrupt("return",!0);case 29:throw t.prev=29,t.t0=t.catch(13),this.contentState=f.d.FAILED,t.t0;case 33:return t.prev=33,e.done(),t.finish(33);case 36:case"end":return t.stop()}}),t,this,[[13,29,33,36]])})));return function(){return t.apply(this,arguments)}}(),e.unloadContent=function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=f.d.UNLOADED,!0},e.updateVisibility=function(t,e){if(this._frameNumber!==t.frameNumber){var i=this.parent,n=i?i._visibilityPlaneMask:h.b.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){var r=i?i.computedTransform:this.tileset.modelMatrix;this._updateTransform(r)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,n),this._visible=this._visibilityPlaneMask!==h.b.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}},e.visibility=function(t,e){var i=t.cullingVolume,n=this.boundingVolume;return i.computeVisibilityWithPlaneMask(n,e)},e.contentVisibility=function(){return!0},e.distanceToTile=function(t){var e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))},e.cameraSpaceZDepth=function(t){var e=t.camera,i=this.boundingVolume;return P.subVectors(i.center,e.position),e.direction.dot(P)},e.insideViewerRequestVolume=function(t){var e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0},e.updateExpiration=function(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){var t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=f.d.EXPIRED,this._expiredContent=this.content)}},e._initializeLodMetric=function(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))},e._initializeTransforms=function(t){this.transform=t.transform?new c.a(t.transform):new c.a;var e=this.parent,i=this.tileset,n=e&&e.computedTransform?e.computedTransform.clone():i.modelMatrix.clone();this.computedTransform=new c.a(n).multiplyRight(this.transform);var r=e&&e._initialTransform?e._initialTransform.clone():new c.a;this._initialTransform=new c.a(r).multiplyRight(this.transform)},e._initializeBoundingVolumes=function(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)},e._initializeContent=function(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=f.d.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)},e._initializeRenderingState=function(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=h.b.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0},e._getRefine=function(t){return t||this.parent&&this.parent.refine||f.e.REPLACE},e._isTileset=function(){return-1!==this.contentUrl.indexOf(".json")},e._onContentLoaded=function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)},e._updateBoundingVolume=function(t){this.boundingVolume=T(t.boundingVolume,this.computedTransform,this.boundingVolume);var e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=T(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=T(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))},e._updateTransform=function(t){void 0===t&&(t=new c.a);var e=t.clone().multiplyRight(this.transform);!e.equals(this.computedTransform)&&(this.computedTransform=e,this._updateBoundingVolume(this.header))},e._getLoaderSpecificOptions=function(t){switch(t){case"i3s":return k(k({},this.tileset.options.i3s),{},{tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1});case"3d-tiles":case"cesium-ion":default:return{assetGltfUpAxis:(e=this.tileset.tileset).asset&&e.asset.gltfUpAxis||"Y"}}var e},Object(o.a)(t,[{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===f.d.READY||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===f.d.UNLOADED}},{key:"contentExpired",get:function(){return this.contentState===f.d.EXPIRED}},{key:"contentFailed",get:function(){return this.contentState===f.d.FAILED}},{key:"extras",get:function(){return this.header.extras}}]),t}()},gOKY:function(t,e,i){"use strict";e.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},rOwd:function(t,e,i){"use strict";i.d(e,"a",(function(){return f})),i.d(e,"c",(function(){return D})),i.d(e,"b",(function(){return X})),i.d(e,"d",(function(){return U})),i.d(e,"e",(function(){return Ot})),i.d(e,"f",(function(){return Bt}));var n=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),r=i("1OyB"),a=i("vuIU"),s=i("zXfU"),o=new s.a,u=new s.a,c=(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(r.a)(this,t),n=n||o.copy(e).add(i).scale(.5),this.center=new s.a(n),this.halfDiagonal=new s.a(i).subtract(this.center),this.minimum=new s.a(e),this.maximum=new s.a(i)}Object(a.a)(t,[{key:"clone",value:function(){return new t(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"intersectPlane",value:function(t){var e=this.halfDiagonal,i=u.from(t.normal),r=e.x*Math.abs(i.x)+e.y*Math.abs(i.y)+e.z*Math.abs(i.z),a=this.center.dot(i)+t.distance;return a-r>0?n.INSIDE:a+r<0?n.OUTSIDE:n.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e,i=o.from(t).subtract(this.center),n=this.halfDiagonal,r=0;return(e=Math.abs(i.x)-n.x)>0&&(r+=e*e),(e=Math.abs(i.y)-n.y)>0&&(r+=e*e),(e=Math.abs(i.z)-n.z)>0&&(r+=e*e),r}}])}(),i("ZaHm")),h=new s.a,l=new s.a,f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,t),this.radius=-0,this.center=new s.a,this.fromCenterRadius(e,i)}return Object(a.a)(t,[{key:"fromCenterRadius",value:function(t,e){return this.center.from(t),this.radius=e,this}},{key:"fromCornerPoints",value:function(t,e){return e=h.from(e),this.center=(new s.a).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new t(this.center,this.radius)}},{key:"union",value:function(t){var e=this.center,i=this.radius,n=t.center,r=t.radius,a=h.copy(n).subtract(e),s=a.magnitude();if(i>=s+r)return this.clone();if(r>=s+i)return t.clone();var o=.5*(i+s+r);return l.copy(a).scale((-i+o)/s).add(e),this.center.copy(l),this.radius=o,this}},{key:"expand",value:function(t){var e=(t=h.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}},{key:"intersectPlane",value:function(t){var e=this.center,i=this.radius,r=t.normal.dot(e)+t.distance;return r<-i?n.OUTSIDE:r<i?n.INTERSECTING:n.INSIDE}},{key:"transform",value:function(t){this.center.transform(t);var e=c.e(h,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){return(t=h.from(t)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}}]),t}(),d=i("KQm4"),m=i("GA6j"),p=i("Xjzu"),v=new s.a,y=new s.a,g=new s.a,b=new s.a,_=new s.a,O=new s.a,w=new s.a,T=new s.a,S=new s.a,j=new s.a,E=0,M=1,x=2,k=3,P=4,C=5,I=6,R=7,N=8,D=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(r.a)(this,t),this.center=(new s.a).from(e),this.halfAxes=new m.a(i)}return Object(a.a)(t,[{key:"fromCenterHalfSizeQuaternion",value:function(t,e,i){var n=new p.a(i),r=(new m.a).fromQuaternion(n);return r[0]=r[0]*e[0],r[1]=r[1]*e[0],r[2]=r[2]*e[0],r[3]=r[3]*e[1],r[4]=r[4]*e[1],r[5]=r[5]*e[1],r[6]=r[6]*e[2],r[7]=r[7]*e[2],r[8]=r[8]*e[2],this.center=(new s.a).from(t),this.halfAxes=r,this}},{key:"clone",value:function(){return new t(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f,e=this.halfAxes,i=e.getColumn(0,T),n=e.getColumn(1,S),r=e.getColumn(2,j),a=v.copy(i).add(n).add(r);return t.center.copy(this.center),t.radius=a.magnitude(),t}},{key:"intersectPlane",value:function(t){var e=this.center,i=t.normal,r=this.halfAxes,a=i.x,s=i.y,o=i.z,u=Math.abs(a*r[E]+s*r[M]+o*r[x])+Math.abs(a*r[k]+s*r[P]+o*r[C])+Math.abs(a*r[I]+s*r[R]+o*r[N]),c=i.dot(e)+t.distance;return c<=-u?n.OUTSIDE:c>=u?n.INSIDE:n.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e=y.from(t).subtract(this.center),i=this.halfAxes,n=i.getColumn(0,g),r=i.getColumn(1,b),a=i.getColumn(2,_),s=n.magnitude(),o=r.magnitude(),u=a.magnitude();n.normalize(),r.normalize(),a.normalize();var c,h=0;return(c=Math.abs(e.dot(n))-s)>0&&(h+=c*c),(c=Math.abs(e.dot(r))-o)>0&&(h+=c*c),(c=Math.abs(e.dot(a))-u)>0&&(h+=c*c),h}},{key:"computePlaneDistances",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=this.center,s=this.halfAxes,o=s.getColumn(0,g),u=s.getColumn(1,b),c=s.getColumn(2,_),h=O.copy(o).add(u).add(c).add(a),l=w.copy(h).subtract(t),f=e.dot(l);return n=Math.min(f,n),r=Math.max(f,r),h.copy(a).add(o).add(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),h.copy(a).add(o).subtract(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),h.copy(a).add(o).subtract(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),a.copy(h).subtract(o).add(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),a.copy(h).subtract(o).add(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),a.copy(h).subtract(o).subtract(u).add(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),a.copy(h).subtract(o).subtract(u).subtract(c),l.copy(h).subtract(t),f=e.dot(l),n=Math.min(f,n),r=Math.max(f,r),i[0]=n,i[1]=r,i}},{key:"getTransform",value:function(){}},{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new s.a(t).len(),new s.a(e).len(),new s.a(i).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),n=new s.a(t).normalize(),r=new s.a(e).normalize(),a=new s.a(i).normalize();return(new p.a).fromMatrix3(new m.a([].concat(Object(d.a)(n),Object(d.a)(r),Object(d.a)(a))))}}]),t}(),A=i("tS8E"),q=i("a3TU"),z=new s.a,V=new s.a,U=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(r.a)(this,t),this.normal=new s.a,this.distance=-0,this.fromNormalDistance(e,i)}return Object(a.a)(t,[{key:"fromNormalDistance",value:function(t,e){return Object(A.a)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}},{key:"fromPointNormal",value:function(t,e){t=z.from(t),this.normal.from(e).normalize();var i=-this.normal.dot(t);return this.distance=i,this}},{key:"fromCoefficients",value:function(t,e,i,n){return this.normal.set(t,e,i),Object(A.a)(Object(q.d)(this.normal.len(),1)),this.distance=n,this}},{key:"clone",value:function(e){return new t(this.normal,this.distance)}},{key:"equals",value:function(t){return Object(q.d)(this.distance,t.distance)&&Object(q.d)(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var e=V.copy(this.normal).transformAsVector(t).normalize(),i=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(i,e)}},{key:"projectPointOntoPlane",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];t=z.from(t);var i=this.getPointDistance(t),n=V.copy(this.normal).scale(i);return t.subtract(n).to(e)}}]),t}();function L(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return F(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return F(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var B=[new s.a([1,0,0]),new s.a([0,1,0]),new s.a([0,0,1])],G=new s.a,W=new s.a,X=(new U(new s.a(1,0,0),0),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(r.a)(this,t),this.planes=e,Object(A.a)(this.planes.every((function(t){return t instanceof U})))}return Object(a.a)(t,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(a.a)(t,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*B.length;var e,i=t.center,n=t.radius,r=0,a=L(B);try{for(a.s();!(e=a.n()).done;){var s=e.value,o=this.planes[r],u=this.planes[r+1];o||(o=this.planes[r]=new U),u||(u=this.planes[r+1]=new U);var c=G.copy(s).scale(-n).add(i);s.dot(c);o.fromPointNormal(c,s);var h=G.copy(s).scale(n).add(i),l=W.copy(s).negate();l.dot(h);u.fromPointNormal(h,l),r+=2}}catch(f){a.e(f)}finally{a.f()}return this}},{key:"computeVisibility",value:function(t){Object(A.a)(t);var e,i=n.INSIDE,r=L(this.planes);try{for(r.s();!(e=r.n()).done;){var a=e.value;switch(t.intersectPlane(a)){case n.OUTSIDE:return n.OUTSIDE;case n.INTERSECTING:i=n.INTERSECTING}}}catch(s){r.e(s)}finally{r.f()}return i}},{key:"computeVisibilityWithPlaneMask",value:function(e,i){if(Object(A.a)(e,"boundingVolume is required."),Object(A.a)(Number.isFinite(i),"parentPlaneMask is required."),i===t.MASK_OUTSIDE||i===t.MASK_INSIDE)return i;for(var r=t.MASK_INSIDE,a=this.planes,s=0;s<this.planes.length;++s){var o=s<31?1<<s:0;if(!(s<31&&0==(i&o))){var u=a[s],c=e.intersectPlane(u);if(c===n.OUTSIDE)return t.MASK_OUTSIDE;c===n.INTERSECTING&&(r|=o)}}return r}}]),t}()),H=i("rePB"),Q=i("Nw31");function Z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function K(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(i),!0).forEach((function(e){Object(H.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Y=new s.a,J=new s.a,$=new s.a,tt=new s.a,et=new s.a,it=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t),e=K({near:1,far:5e8},e),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this._cullingVolume=new X([new U,new U,new U,new U,new U,new U]),this._perspectiveMatrix=new Q.a,this._infinitePerspective=new Q.a}return Object(a.a)(t,[{key:"clone",value:function(){return new t({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(e){return e&&e instanceof t&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far}},{key:"computeCullingVolume",value:function(t,e,i){Object(A.a)(t,"position is required."),Object(A.a)(e,"direction is required."),Object(A.a)(i,"up is required.");var n=this._cullingVolume.planes;i=Y.copy(i).normalize();var r=J.copy(e).cross(i).normalize(),a=$.copy(e).multiplyByScalar(this.near).add(t),o=tt.copy(e).multiplyByScalar(this.far).add(t),u=et;return u.copy(r).multiplyByScalar(this.left).add(a).subtract(t).cross(i),n[0].fromPointNormal(t,u),u.copy(r).multiplyByScalar(this.right).add(a).subtract(t).cross(i).negate(),n[1].fromPointNormal(t,u),u.copy(i).multiplyByScalar(this.bottom).add(a).subtract(t).cross(r).negate(),n[2].fromPointNormal(t,u),u.copy(i).multiplyByScalar(this.top).add(a).subtract(t).cross(r),n[3].fromPointNormal(t,u),u=(new s.a).copy(e),n[4].fromPointNormal(a,u),u.negate(),n[5].fromPointNormal(o,u),this._cullingVolume}},{key:"getPixelDimensions",value:function(t,e,i,n){nt(this),Object(A.a)(Number.isFinite(t)&&Number.isFinite(e)),Object(A.a)(t>0),Object(A.a)(e>0),Object(A.a)(i>0),Object(A.a)(n);var r=1/this.near,a=this.top*r,s=2*i*a/e,o=2*i*(a=this.right*r)/t;return n.x=o,n.y=s,n}},{key:"projectionMatrix",get:function(){return nt(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return nt(this),this._infinitePerspective}}]),t}();function nt(t){Object(A.a)(Number.isFinite(t.right)&&Number.isFinite(t.left)&&Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t.top,i=t.bottom,n=t.right,r=t.left,a=t.near,s=t.far;e===t._top&&i===t._bottom&&r===t._left&&n===t._right&&a===t._near&&s===t._far||(Object(A.a)(t.near>0&&t.near<t.far,"near must be greater than zero and less than far."),t._left=r,t._right=n,t._top=e,t._bottom=i,t._near=a,t._far=s,t._perspectiveMatrix=(new Q.a).frustum({left:r,right:n,bottom:i,top:e,near:a,far:s}),t._infinitePerspective=(new Q.a).frustum({left:r,right:n,bottom:i,top:e,near:a,far:1/0}))}function rt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function at(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(i),!0).forEach((function(e){Object(H.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):rt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}!function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t),e=at({near:1,far:5e8,xOffset:0,yOffset:0},e),this._offCenterFrustum=new it,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this.xOffset=e.xOffset,this._xOffset=this.xOffset,this.yOffset=e.yOffset,this._yOffset=this.yOffset}Object(a.a)(t,[{key:"clone",value:function(){return new t({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(e){return null!=e&&e instanceof t&&(st(this),st(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum))}},{key:"computeCullingVolume",value:function(t,e,i){return st(this),this._offCenterFrustum.computeCullingVolume(t,e,i)}},{key:"getPixelDimensions",value:function(t,e,i,n){return st(this),this._offCenterFrustum.getPixelDimensions(t,e,i,n)}},{key:"projectionMatrix",get:function(){return st(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return st(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return st(this),this._fovy}},{key:"sseDenominator",get:function(){return st(this),this._sseDenominator}}])}();function st(t){Object(A.a)(Number.isFinite(t.fov)&&Number.isFinite(t.aspectRatio)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t._offCenterFrustum;t.fov===t._fov&&t.aspectRatio===t._aspectRatio&&t.near===t._near&&t.far===t._far&&t.xOffset===t._xOffset&&t.yOffset===t._yOffset||(Object(A.a)(t.fov>=0&&t.fov<Math.PI),Object(A.a)(t.aspectRatio>0),Object(A.a)(t.near>=0&&t.near<t.far),t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:2*Math.atan(Math.tan(.5*t.fov)/t.aspectRatio),t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,e.top=t.near*Math.tan(.5*t._fovy),e.bottom=-e.top,e.right=t.aspectRatio*e.top,e.left=-e.right,e.near=t.near,e.far=t.far,e.right+=t.xOffset,e.left+=t.xOffset,e.top+=t.yOffset,e.bottom+=t.yOffset)}function ot(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return ut(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ut(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ct=new s.a,ht=new s.a,lt=new s.a,ft=new s.a,dt=new s.a,mt=new s.a,pt=new s.a,vt=new s.a,yt=new s.a,gt=new s.a,bt=new s.a,_t=new s.a;Math.PI;function Ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new f;if(!t||0===t.length)return e.fromCenterRadius([0,0,0],0);var i,n=pt.copy(t[0]),r=ct.copy(n),a=ht.copy(n),s=lt.copy(n),o=ft.copy(n),u=dt.copy(n),c=mt.copy(n),h=ot(t);try{for(h.s();!(i=h.n()).done;){var l=i.value;n.copy(l);var d=n.x,m=n.y,p=n.z;d<r.x&&n.copy(r),d>o.x&&n.copy(o),m<a.y&&n.copy(a),m>u.y&&n.copy(u),p<s.z&&n.copy(s),p>c.z&&n.copy(c)}}catch(A){h.e(A)}finally{h.f()}var v=vt.copy(o).subtract(r).magnitudeSquared(),y=vt.copy(u).subtract(a).magnitudeSquared(),g=vt.copy(c).subtract(s).magnitudeSquared(),b=r,_=o,O=v;y>O&&(O=y,b=a,_=u),g>O&&(O=g,b=s,_=c);var w=yt;w.x=.5*(b.x+_.x),w.y=.5*(b.y+_.y),w.z=.5*(b.z+_.z);var T=vt.copy(_).subtract(w).magnitudeSquared(),S=Math.sqrt(T),j=gt;j.x=r.x,j.y=a.y,j.z=s.z;var E=bt;E.x=o.x,E.y=u.y,E.z=c.z;var M,x=_t.copy(j).add(E).multiplyByScalar(.5),k=0,P=ot(t);try{for(P.s();!(M=P.n()).done;){var C=M.value;n.copy(C);var I=vt.copy(n).subtract(x).magnitude();I>k&&(k=I);var R=vt.copy(n).subtract(w).magnitudeSquared();if(R>T){var N=Math.sqrt(R);T=(S=.5*(S+N))*S;var D=N-S;w.x=(S*w.x+D*n.x)/N,w.y=(S*w.y+D*n.y)/N,w.z=(S*w.z+D*n.z)/N}}}catch(A){P.e(A)}finally{P.f()}return S<k?(w.to(e.center),e.radius=S):(x.to(e.center),e.radius=k),e}var wt=i("gOKY"),Tt=new m.a,St=new m.a,jt=new m.a,Et=new m.a,Mt=new m.a;function xt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=wt.a.EPSILON20,n=10,r=0,a=0,s=St,o=jt;s.identity(),o.copy(t);for(var u=i*kt(o);a<n&&It(o)>u;)Rt(o,Et),Mt.copy(Et).transpose(),o.multiplyRight(Et),o.multiplyLeft(Mt),s.multiplyRight(Et),++r>2&&(++a,r=0);return e.unitary=s.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function kt(t){for(var e=0,i=0;i<9;++i){var n=t[i];e+=n*n}return Math.sqrt(e)}var Pt=[1,0,0],Ct=[2,2,1];function It(t){for(var e=0,i=0;i<3;++i){var n=t[Tt.getElementIndex(Ct[i],Pt[i])];e+=2*n*n}return Math.sqrt(e)}function Rt(t,e){for(var i=wt.a.EPSILON15,n=0,r=1,a=0;a<3;++a){var s=Math.abs(t[Tt.getElementIndex(Ct[a],Pt[a])]);s>n&&(r=a,n=s)}var o=Pt[r],u=Ct[r],c=1,h=0;if(Math.abs(t[Tt.getElementIndex(u,o)])>i){var l,f=(t[Tt.getElementIndex(u,u)]-t[Tt.getElementIndex(o,o)])/2/t[Tt.getElementIndex(u,o)];h=(l=f<0?-1/(-f+Math.sqrt(1+f*f)):1/(f+Math.sqrt(1+f*f)))*(c=1/Math.sqrt(1+l*l))}return m.a.IDENTITY.to(e),e[Tt.getElementIndex(o,o)]=e[Tt.getElementIndex(u,u)]=c,e[Tt.getElementIndex(u,o)]=h,e[Tt.getElementIndex(o,u)]=-h,e}function Nt(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Dt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Dt(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){o=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(o)throw a}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var At=new s.a,qt=new s.a,zt=new s.a,Vt=new s.a,Ut=new s.a,Lt=new m.a,Ft={diagonal:new m.a,unitary:new m.a};function Bt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new D;if(!t||0===t.length)return e.halfAxes=new m.a([0,0,0,0,0,0,0,0,0]),e.center=new s.a,e;var i,n=t.length,r=new s.a(0,0,0),a=Nt(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;r.add(o)}}catch(V){a.e(V)}finally{a.f()}var u=1/n;r.multiplyByScalar(u);var c,h=0,l=0,f=0,d=0,p=0,v=0,y=Nt(t);try{for(y.s();!(c=y.n()).done;){var g=c.value,b=At.copy(g).subtract(r);h+=b.x*b.x,l+=b.x*b.y,f+=b.x*b.z,d+=b.y*b.y,p+=b.y*b.z,v+=b.z*b.z}}catch(V){y.e(V)}finally{y.f()}h*=u,l*=u,f*=u,d*=u,p*=u,v*=u;var _=Lt;_[0]=h,_[1]=l,_[2]=f,_[3]=l,_[4]=d,_[5]=p,_[6]=f,_[7]=p,_[8]=v;var O,w=xt(_,Ft),T=w.unitary,S=e.halfAxes.copy(T),j=S.getColumn(0,zt),E=S.getColumn(1,Vt),M=S.getColumn(2,Ut),x=-Number.MAX_VALUE,k=-Number.MAX_VALUE,P=-Number.MAX_VALUE,C=Number.MAX_VALUE,I=Number.MAX_VALUE,R=Number.MAX_VALUE,N=Nt(t);try{for(N.s();!(O=N.n()).done;){var A=O.value;x=Math.max(A.dot(j),x),k=Math.max(A.dot(E),k),P=Math.max(A.dot(M),P),C=Math.min(A.dot(j),C),I=Math.min(A.dot(E),I),R=Math.min(A.dot(M),R)}}catch(V){N.e(V)}finally{N.f()}j=j.multiplyByScalar(.5*(C+x)),E=E.multiplyByScalar(.5*(I+k)),M=M.multiplyByScalar(.5*(R+P)),e.center.copy(j).add(E).add(M);var q=qt.set(x-C,k-I,P-R).multiplyByScalar(.5),z=new m.a([q[0],0,0,0,q[1],0,0,0,q[2]]);return e.halfAxes.multiplyRight(z),e}},vrw9:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i("rePB"),r=i("vuIU"),a=i("Qk7e"),s=function(){function t(t){void 0===t&&(t=0),this._array=new Array(t),this._map=new Map,this._length=t}var e=t.prototype;return e.get=function(t){return Object(a.a)(t<this._array.length),this._array[t]},e.set=function(t,e){Object(a.a)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)},e.delete=function(t){var e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)},e.peek=function(){return this._array[this._length-1]},e.push=function(t){if(!this._map.has(t)){var e=this.length++;this._array[e]=t,this._map.set(t,e)}},e.pop=function(){var t=this._array[--this.length];return this._map.delete(t),t},e.reserve=function(t){Object(a.a)(t>=0),t>this._array.length&&(this._array.length=t)},e.resize=function(t){Object(a.a)(t>=0),this.length=t},e.trim=function(t){null==t&&(t=this.length),this._array.length=t},e.reset=function(){this._array=[],this._map=new Map,this._length=0},e.find=function(t){return this._map.has(t)},Object(r.a)(t,[{key:"length",get:function(){return this._length},set:function(t){this._length=t,t>this._array.length&&(this._array.length=t)}},{key:"values",get:function(){return this._array}}]),t}(),o=i("FJ6+");function u(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:function(){},viewportTraversersMap:{},basePath:""},d=function(){function t(t){this.options=l(l({},f),t),this._traversalStack=new s,this._emptyTraversalStack=new s,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}var e=t.prototype;return e.traverse=function(t,e,i){this.root=t,this.options=l(l({},this.options),i),this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)},e.reset=function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()},e.executeTraversal=function(t,e){var i=this._traversalStack;for(t._selectionDepth=1,i.push(t);i.length>0;){var n=i.pop(),r=!1;this.canTraverse(n,e)&&(this.updateChildTiles(n,e),r=this.updateAndPushChildren(n,e,i,n.hasRenderContent?n._selectionDepth+1:n._selectionDepth));var a=n.parent,s=Boolean(!a||a._shouldRefine),u=!r;n.hasRenderContent?n.refine===o.e.ADD?(this.loadTile(n,e),this.selectTile(n,e)):n.refine===o.e.REPLACE&&(this.loadTile(n,e),u&&this.selectTile(n,e)):(this.emptyTiles[n.id]=n,this.loadTile(n,e),u&&this.selectTile(n,e)),this.touchTile(n,e),n._shouldRefine=r&&s}this.options.onTraversalEnd(e)},e.updateChildTiles=function(t,e){for(var i,n=u(t.children);!(i=n()).done;){var r=i.value;this.updateTile(r,e)}return!0},e.updateAndPushChildren=function(t,e,i,n){var r=this.options,a=r.loadSiblings,s=r.skipLevelOfDetail,c=t.children;c.sort(this.compareDistanceToCamera.bind(this));for(var h,l=t.refine===o.e.REPLACE&&t.hasRenderContent&&!s,f=!1,d=!0,m=u(c);!(h=m()).done;){var p=h.value;if(p._selectionDepth=n,p.isVisibleAndInRequestVolume?(i.find(p)&&i.delete(p),i.push(p),f=!0):(l||a)&&(this.loadTile(p,e),this.touchTile(p,e)),l){var v=void 0;if(v=!!p._inRequestVolume&&(p.hasRenderContent?p.contentAvailable:this.executeEmptyTraversal(p,e)),!(d=d&&v))return!1}}return f||(d=!1),d},e.updateTile=function(t,e){this.updateTileVisibility(t,e)},e.selectTile=function(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)},e.loadTile=function(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)},e.touchTile=function(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber},e.canTraverse=function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:!(!n&&!t.isVisibleAndInRequestVolume)&&this.shouldRefine(t,e,i))},e.shouldLoadTile=function(t){return t.hasUnloadedContent||t.contentExpired},e.shouldSelectTile=function(t){return t.contentAvailable&&!this.options.skipLevelOfDetail},e.shouldRefine=function(t,e,i){var n=t._screenSpaceError;return i&&(n=t.getScreenSpaceError(e,!0)),n>this.options.maximumScreenSpaceError},e.updateTileVisibility=function(t,e){var i=[];if(this.options.viewportTraversersMap)for(var n in this.options.viewportTraversersMap){this.options.viewportTraversersMap[n]===e.viewport.id&&i.push(n)}else i.push(e.viewport.id);t.updateVisibility(e,i)},e.compareDistanceToCamera=function(t,e){return t._distanceToCamera-e._distanceToCamera},e.anyChildrenVisible=function(t,e){for(var i,n=!1,r=u(t.children);!(i=r()).done;){var a=i.value;a.updateVisibility(e),n=n||a.isVisibleAndInRequestVolume}return n},e.executeEmptyTraversal=function(t,e){var i=!0,n=this._emptyTraversalStack;for(n.push(t);n.length>0&&i;){var r=n.pop();if(this.updateTile(r,e),r.isVisibleAndInRequestVolume||this.loadTile(r,e),this.touchTile(r,e),!r.hasRenderContent&&this.canTraverse(r,e,!1,!0))for(var a,s=u(r.children);!(a=s()).done;){var o=a.value;n.find(o)&&n.delete(o),n.push(o)}else r.contentAvailable||(i=!1)}return i},t}()},wBSN:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var n=i("rePB"),r=i("1OyB"),a=i("vuIU"),s=i("XPjF"),o=function(){function t(e,i){Object(r.a)(this,t),this.name=e,this.type=i,this.sampleSize=1,this.reset()}return Object(a.a)(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(s.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(s.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),u=function(){function t(e){var i=e.id,n=e.stats;Object(r.a)(this,t),this.id=i,this.stats={},this._initializeStats(n),Object.seal(this)}return Object(a.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,i=t.type;return this.stats[e]||(this.stats[e]=t instanceof o?t:new o(e,i)),this.stats[e]}}]),t}();function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){Object(n.a)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var l={id:"request-scheduler",throttleRequests:!0,maxRequests:6},f=function(){function t(t){void 0===t&&(t={}),this.activeRequestCount=0,this.requestQueue=[],this.requestMap=new Map,this.deferredUpdate=null,this.props=h(h({},l),t),this.stats=new u({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}var e=t.prototype;return e.scheduleRequest=function(t,e){if(void 0===e&&(e=function(){return 0}),!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var i={handle:t,priority:0,getPriority:e},n=new Promise((function(t){return i.resolve=t,i}));return this.requestQueue.push(i),this.requestMap.set(t,n),this._issueNewRequests(),n},e._issueRequest=function(t){var e=this,i=t.handle,n=t.resolve,r=!1,a=function(){r||(r=!0,e.requestMap.delete(i),e.activeRequestCount--,e._issueNewRequests())};return this.activeRequestCount++,n?n({done:a}):Promise.resolve({done:a})},e._issueNewRequests=function(){var t=this;this.deferredUpdate||(this.deferredUpdate=setTimeout((function(){return t._issueNewRequestsAsync()}),0))},e._issueNewRequestsAsync=function(){this.deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(var e=0;e<t;++e){var i=this.requestQueue.shift();i&&this._issueRequest(i)}}},e._updateAllRequests=function(){for(var t=this.requestQueue,e=0;e<t.length;++e){var i=t[e];this._updateRequest(i)||(t.splice(e,1),this.requestMap.delete(i.handle),e--)}t.sort((function(t,e){return t.priority-e.priority}))},e._updateRequest=function(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)},t}()}}]);